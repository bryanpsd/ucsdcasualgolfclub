---
import { Image } from 'astro:assets';
import logo from '~assets/brand-logo.png';
import { MainNav } from './components/MainNav';

import { menuItems } from './utils/headerItems';
import {
  headerWrapper,
  header,
  logoWrapper,
  logoLink,
  mainContentJumpLink,
} from './Header.css';
import { MobileNav } from './components/MobileNav/MobileNav';
import { Banner } from './components/Banner';
import { contentfulClient } from '~lib/contentful';
import type { TypeBannerSkeleton } from '~types/contentful/TypeBanner';

const entries = await contentfulClient.getEntries<TypeBannerSkeleton>({
  content_type: 'banner',
});

const { pathname } = Astro.url;
---

<a class={`sr-only ${mainContentJumpLink}`} href="#main">Jump to main content</a
>
<Banner
  banner={entries.items
    .map((item) => ({
      body: item.fields.body,
      global: item.fields.global || false,
      pages: item.fields.pages || [],
    }))
    .filter(
      (
        banner
      ): banner is {
        body: Document | undefined;
        global: boolean;
        pages: string[];
      } => banner.body !== undefined
    )}
  currentPath={pathname}
  client:load
/>
<header class={headerWrapper}>
  <div class={header}>
    <div class={logoWrapper}>
      <a class={logoLink} href="/">
        <Image src={logo} alt="UCSD Casual Golf Club" height={30} width={30} />
        UCSD Casual Golf Club
      </a>
    </div>
    <MainNav items={menuItems} currentPath={pathname} client:load />
    <MobileNav items={menuItems} currentPath={pathname} client:load />
  </div>
</header>

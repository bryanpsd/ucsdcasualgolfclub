---
import { actions } from 'astro:actions';
import { Table } from '~components/Table';

import type { TypeResultsProps } from '~types/contentful/TypeResults';

const safeResult = await Astro.callAction(actions.getResults, null);

if (safeResult.error) {
  throw new Error(`Failed to fetch results: ${safeResult.error.message}`);
}

const results: TypeResultsProps[] = safeResult.data || [];
---

<Table
  thead={[
    'Player',
    'Index',
    'Course Handicap',
    'Gross',
    'Net',
    'Putts',
    'Closest To',
    'Long Drive',
  ]}
  tbody={results.map((result) => [
    result.gross,
    result.courseHandicap,
    result.putts,
    result.closestTo,
    result.longDrive,
  ])}
/>
